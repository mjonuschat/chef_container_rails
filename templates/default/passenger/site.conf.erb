passenger_show_version_in_header off;

server {
    listen 80;

    server_name <%= node['container_rails']['app']['server_name'] %>;

    root /home/app/public;

    if ($request_method !~ ^(GET|HEAD|PUT|PATCH|POST|DELETE|OPTIONS)$ ){
        return 405;
    }

    location ~ ^/assets/ {
        gzip_static on;

        expires 1y;
        add_header Cache-Control public;

        add_header ETag "";
        break;
    }

    passenger_enabled on;
    passenger_user app;
    passenger_friendly_error_pages <%= node['container_rails']['app']['friendly_error_pages'] %>;
}
